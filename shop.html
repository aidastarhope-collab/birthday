<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>üíå letters</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --bg:#031628; --paper:#fff; --text:#374151;
    --wrap:#f5edd1; --flap:#ecdeb8; --body:#e6cfa7;
    --accent:#f59e0b; --btn:#fbbf24; --btn-hover:#fcd34d;
    --seal:#541717;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif}
  header{max-width:1100px;margin:24px auto 8px;padding:0 16px}
  h1{margin:0 0 10px}
  .meta{opacity:.9;margin:0 0 10px}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  .btn{padding:10px 14px;border:0;border-radius:10px;font-weight:700;cursor:pointer}
  .btn.primary{background:#000000;color:#fff}
  .btn.primary:hover{background:#000000}
  .btn.light{background:#f3f4f6;color:#111}

  /* Grid */
  .grid{
    max-width:1100px; margin:18px auto 48px; padding:0 16px;
    display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));
    gap:20px;
  }

  /* Karte */
  .card{
    background:var(--wrap);
    border:2px solid var(--accent);
    border-radius:14px;
    padding:16px;
    color:#111;
    display:flex; 
    flex-direction:column;
    gap:16px;
    transition:opacity .2s ease;
    min-height:280px;
  }
  .card.locked{opacity:.4; filter:grayscale(50%)}

  /* Umschlag Container */
  .envelope{
    position:relative;
    width: 100%;
    height:180px;
    background:var(--body);
    border-radius:10px;
    overflow:hidden;
    box-shadow:0 4px 8px rgba(0,0,0,.15);
  }

  /* Brief-Inhalt - versteckt bis ge√∂ffnet */
  .letter{
    position:absolute;
    top:15px; left:15px; right:15px; bottom:15px;
    background:var(--paper);
    color:var(--text);
    border-radius:6px;
    padding:16px;
    box-shadow:0 2px 8px rgba(0,0,0,.1);
    z-index:1;
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    opacity:0;
    transform:scale(0.8);
    transition:all 0.5s ease;
  }
  .letter p{
    margin:0;
    font-size:14px;
    line-height:1.5;
  }

  /* Umschlag-K√∂rper */
  .envelope-body{
    position:absolute;
    top:80px; left:0; right:0; bottom:0;
    background:var(--body);
    border-radius:0 0 10px 10px;
    z-index:2;
    transition:transform 0.6s ease;
  }

  /* Umschlag-Klappe mit Siegel */
  .envelope-flap{
    position:absolute;
    top:0; left:0; right:0;
    height:100px;
    background:var(--flap);
    clip-path:polygon(0% 0%, 100% 0%, 50% 80%);
    z-index:3;
    transition:transform 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    transform-origin:top center;
  }

  /* Herz-Siegel auf der Klappe */
  .seal{
    position:absolute;
    top:65px;
    left:50%;
    width:22px;
    height:22px;
    background:var(--seal);
    transform:translate(-50%, -50%) rotate(45deg);
    border-radius:3px 0;
    box-shadow:0 3px 8px rgba(251, 24, 227, 0.6);
  }
  .seal::before,
  .seal::after {
    content:'';
    position:absolute;
    width:22px;
    height:22px;
    background:var(--seal);
    border-radius:50%;
  }
  .seal::before { top:-11px; left:0; }
  .seal::after { top:0; left:-11px; }

  /* Ge√∂ffneter Zustand */
  .card.opened .envelope-flap{
    transform:rotateX(-180deg);
  }
  .card.opened .envelope-body{
    transform:translateY(100%);
  }
  .card.opened .letter{
    opacity:1;
    transform:scale(1);
    transition-delay:0.4s;
  }

  /* Footer */
  .card-footer{
    display:flex; 
    gap:12px; 
    align-items:center; 
    justify-content:space-between;
  }
  .card-title{
    margin:0; 
    font-size:16px; 
    font-weight:800; 
    color:#111;
    display:flex; 
    align-items:center; 
    gap:8px;
  }
  .badge{
    font-size:11px; 
    font-weight:700; 
    color:#111;
    background:#fde68a; 
    border:1px dashed var(--accent);
    padding:3px 8px; 
    border-radius:12px;
  }
  .toggle-btn{
    padding:8px 12px;
    border:0; 
    border-radius:8px; 
    font-weight:700; 
    cursor:pointer;
    background:var(--btn);
    font-size:13px;
    transition:all .2s ease;
  }
  .toggle-btn:hover:not(:disabled){
    background:var(--btn-hover);
    transform:translateY(-1px);
  }
  .toggle-btn:disabled{opacity:0.5; cursor:not-allowed; background:#999;}

  @media (max-width: 768px) {
    .grid{
      grid-template-columns:1fr;
    }
  }
</style>

<style>
:root{
  --ink:#e5e7eb; --muted:#9ca3af;
  --panel:rgba(255,255,255,0.06); --border:rgba(255,255,255,0.12);
}
body{background:linear-gradient(180deg,#0b1220,#0f172a);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial}
.topnav{position:sticky;top:0;z-index:10;backdrop-filter:blur(10px);background:rgba(255,255,255,0.06);border-bottom:1px solid var(--border)}
.topnav .wrap{max-width:1100px;margin:0 auto;padding:10px 16px;display:flex;align-items:center;justify-content:space-between}
.topnav .links{display:flex;gap:10px;flex-wrap:wrap}
.topnav .links a{display:inline-block;padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,0.2);text-decoration:none;color:#e5e7eb;background:rgba(0,0,0,0.25);font-weight:700}
.pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:rgba(0,0,0,0.25);border:1px solid rgba(255,255,255,0.2);font-weight:700;color:#e5e7eb}
</style>

</head>
<body>

<header class="topnav">
  <div class="wrap">
    <nav class="links">
      <a href="index.html">Home</a>
      <a href="minigames.html">Minigames</a>
      <a href="quests.html">Quests</a>
      <a href="shop.html">Shop</a>
    </nav>
    <div class="pill">ü™ô Coins: <span id="coinCount">0</span></div>
  </div>
</header>


<header>
  <h1>üíå ùêãùêûùê≠ùê≠ùêûùê´ùê¨ ùêüùê®ùê´ ùê≤ùê®ùêÆ <ùüë</h1>
  <div class="meta" id="meta">‚Äì</div>
  <div class="actions">
    <button id="reset" class="btn light">reset progress</button>
  </div>
</header>

<section class="grid" id="grid"></section>


<script>
(() => {
  // --- Shared store ---
  const store = {
    get coins(){ return parseInt(localStorage.getItem('ldg_coins')||'0',10) },
    set coins(v){ localStorage.setItem('ldg_coins', String(v)); const hud=document.getElementById('coinCount'); if(hud) hud.textContent=String(v); },
    get purchases(){ return JSON.parse(localStorage.getItem('ldg_purchases')||'{}') },
    set purchases(v){ localStorage.setItem('ldg_purchases', JSON.stringify(v)) },
  };
  function buy(id, price){ if(store.coins < price) return false; const p=store.purchases; store.coins = store.coins - price; p[id]=true; store.purchases=p; return true; }
  function owns(id){ return !!store.purchases[id]; }

  const LETTER_PRICE = 15;
  const MESSAGES = [
    "with you, everything in life feels so much easier","youre the reason even difficult days feel possible","your presence feels like a home i never want to leave","you make life sweeter just by existing","im so glad i get to love you","when i look at you, my heart feels like a firework","even in my dreams, i look for you","i would choose your presence over any perfect place","youre my favorite part of every day","i dont just love what you do for me, i love who you are",
    "being with you could never be a waste of time","every time you smile at me, i feel like the luckiest person alive","even on cloudy days, youre my sunshine","i would search for your soul in any lifetime","you are the calm in my storms and the light in my darkness","thinking of you makes my heart melt","every time I see you, i fall in love with you again","if your voice was a song, i would listen to it on repeat for the rest of my life","youre the first person who has ever made me feel truly loved","you make ordinary moments extraordinary just by being in them",
    "all your funny and autistic moments make you even more loveable to me","even if you did nothing at all, you would still be amazing, just because you are you","even on my happiest days, youre still the best part of them","being loved by you is the best gift life has ever given me","being with you makes me feel safe in this chaotic world","your laugh and that little giggle are like music to my soul","every night when i go to bed, i hope that i dream of you","we could sit in silence for hours and i would still appreciate every second","i am never not thinking about you, youre always on my mind","hearing your voice feels like a warm summer breeze",
    "i will never stop being grateful for you. not just for what you do, but for who you are","if souls were stars, yours would be the one brightest one in the night sky","every part of you is worth loving, from your voice to your smile to your soul","your smile is pure sunshine to me","your existence alone makes my life brighter","even the smallest moments with you feel like a memory thats worth keeping forever","the way you are is more than i could ever dream of",
    "you give me happiness i thought i could only have as a kid","you are the best decision my heart ever made","if anyone asked me about love, i would tell them about you"
  ];

  const grid = document.getElementById('grid');
  const meta = document.getElementById('meta');

  function countUnlocked(){
    const p = store.purchases; let cnt=0; for(const k in p){ if(k.startsWith('letter-') && p[k]) cnt++; } return cnt;
  }

  function updateMeta(){
    const cnt = countUnlocked();
    if(meta) meta.textContent = `unlocked: ${Math.min(cnt, MESSAGES.length)} / ${MESSAGES.length} (Score: ${cnt})`;
  }

  function render(){
    grid.innerHTML='';
    MESSAGES.forEach((message, index) => {
      const id = `letter-${index+1}`; const isUnlocked = owns(id);

      const card = document.createElement('div');
      card.className = 'card' + (isUnlocked ? '' : ' locked');

      const envelope = document.createElement('div'); envelope.className = 'envelope';
      const letter = document.createElement('div'); letter.className = 'letter';
      const letterText = document.createElement('p'); letterText.textContent = message; letter.appendChild(letterText);
      const envelopeBody = document.createElement('div'); envelopeBody.className = 'envelope-body';
      const envelopeFlap = document.createElement('div'); envelopeFlap.className = 'envelope-flap';
      const seal = document.createElement('div'); seal.className = 'seal'; envelopeFlap.appendChild(seal);
      envelope.appendChild(letter); envelope.appendChild(envelopeBody); envelope.appendChild(envelopeFlap);

      const footer = document.createElement('div'); footer.className = 'card-footer';
      const title = document.createElement('h3'); title.className = 'card-title';
      const badge = `<span class="badge">${isUnlocked ? 'unlocked' : 'locked'}</span>`;
      title.innerHTML = `letter ${index + 1} ${badge}`;

      const button = document.createElement('button'); button.className = 'toggle-btn';

      function makeOpenButton(){
        button.textContent = 'open';
        button.disabled = false;
        let isOpen = false;
        button.onclick = () => {
          isOpen = !isOpen;
          if (isOpen) { card.classList.add('opened'); button.textContent = 'close'; }
          else { card.classList.remove('opened'); button.textContent = 'open'; }
        };
      }

      if (!isUnlocked) {
        button.textContent = `buy (ü™ô ${LETTER_PRICE})`;
        button.disabled = store.coins < LETTER_PRICE;
        button.onclick = () => {
          if (buy(id, LETTER_PRICE)) {
            // Unlock UI
            card.classList.remove('locked');
            title.innerHTML = `letter ${index + 1} <span class="badge">unlocked</span>`;
            makeOpenButton();
            updateMeta();
          } else {
            // still not enough coins; keep disabled state updated
            button.disabled = true;
          }
        };
      } else {
        makeOpenButton();
      }

      footer.appendChild(title);
      footer.appendChild(button);
      card.appendChild(envelope);
      card.appendChild(footer);
      grid.appendChild(card);
    });

    updateMeta();
  }

  // Reset Button: reset BOTH coins and letter purchases
  document.getElementById('reset').addEventListener('click', () => {
    if (confirm('reset progress? (coins and letters will reset)')) {
      localStorage.removeItem('ldg_coins');
      localStorage.removeItem('ldg_purchases');
      location.reload();
    }
  });

  // Keep HUD and buy buttons responsive if coins change from other tabs/pages
  window.addEventListener('storage', (e) => {
    if (e.key === 'ldg_coins') {
      const hud=document.getElementById('coinCount');
      if (hud) hud.textContent = String(parseInt(localStorage.getItem('ldg_coins')||'0',10));
      // re-render to refresh button disabled states
      render();
    }
  });

  // Initial render
  render();
})();
</script>

<script>
  (function(){
    function u(){ var el=document.getElementById('coinCount'); if(el){ el.textContent=String(parseInt(localStorage.getItem('ldg_coins')||'0',10)); } }
    u(); window.addEventListener('storage', u);
  })();
</script>
</body>
</html>
